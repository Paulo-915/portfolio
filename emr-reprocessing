# üîÅ EMR Reprocessing ‚Äî Automa√ß√£o de Reprocessamentos e Cargas Hist√≥ricas

Este projeto tem como objetivo automatizar o processo de execu√ß√£o de reprocessamentos e cargas hist√≥ricas em clusters EMR, anteriormente realizados de forma manual. A automa√ß√£o traz mais efici√™ncia, rastreabilidade e escalabilidade √† opera√ß√£o de dados.

## ‚úÖ Feature Finalizada

A automa√ß√£o cobre desde o disparo inicial via S3 at√© a execu√ß√£o de jobs Spark e envio de notifica√ß√µes, com controle completo via Athena.

## üîß Como Funciona o Novo Fluxo Automatizado

1. **Disparo Inicial**  
   O processo se inicia com a inser√ß√£o de um arquivo JSON em um bucket espec√≠fico no S3.

2. **Valida√ß√£o**  
   Uma fun√ß√£o Lambda (`lambda_1`) √© acionada via evento de put, interpretando o conte√∫do do arquivo e validando as vari√°veis obrigat√≥rias.

3. **Execu√ß√£o com Cluster Ativo**  
   - Se houver um cluster EMR ativo, uma mensagem √© enviada para uma fila SQS.  
   - Uma Lambda (`lambda_4`) consome essa fila, submete as vari√°veis e executa o `spark-submit`.  
   - O processo √© registrado em uma tabela de controle com `INSERT` e `UPDATE` ao final.

4. **Execu√ß√£o sem Cluster Ativo**  
   - Caso n√£o haja cluster dispon√≠vel, outra fila SQS √© acionada para criar um novo cluster.  
   - Ap√≥s a cria√ß√£o, uma terceira fila monitora o status at√© o estado `RUNNING`.  
   - Em seguida, o job √© submetido conforme o fluxo anterior.

5. **Notifica√ß√£o de Resultado**  
   - Uma Lambda (`lambda_5`) √© acionada por eventos do EMR e envia notifica√ß√µes formatadas via webhook.  
   - Tamb√©m atualiza o status do processo na tabela de controle.

## üìå Pontos Importantes

- Arquitetura orientada a eventos com uso intensivo de AWS Lambda, S3, SQS e EMR.
- Garantia de rastreabilidade e controle de execu√ß√£o via tabela de controle no Athena.
- Modularidade e escalabilidade para m√∫ltiplos tipos de reprocessamentos.

## üöÄ Melhorias Futuras

- **Organiza√ß√£o de Arquivos**: Movimenta√ß√£o autom√°tica de arquivos JSON j√° processados para diret√≥rios espec√≠ficos.
- **Notifica√ß√µes Automatizadas**: Envio de e-mails ao solicitante ao final do processo.
- **Encadeamento de Processos**: Implementa√ß√£o de l√≥gica para reprocessamentos dependentes em cadeia.

---

üìÅ Este projeto faz parte do meu portf√≥lio de engenharia de dados.  
üìé Os c√≥digos est√£o organizados por fun√ß√£o Lambda e validados em ambiente AWS.

